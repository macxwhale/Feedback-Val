import{l as w,t as d,m as _,n as S,o as k,p as I,q as D,v as p,w as b,x as T,s as C,r as X,h as O,j as n,C as R,e as q,f as E,g as A,y as F,a as H,S as y,B as N}from"./index-BT9tAPmJ.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=w("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);function j(s,a){const t=d(s),o=d(a),e=t.getTime()-o.getTime();return e<0?-1:e>0?1:e}function L(s){return _(s,Date.now())}function P(s){return a=>{const o=(s?Math[s]:Math.trunc)(a);return o===0?0:o}}function Y(s,a){return+d(s)-+d(a)}function z(s){const a=d(s);return a.setHours(23,59,59,999),a}function B(s){const a=d(s);return+z(a)==+S(a)}function Q(s,a){const t=d(s),o=d(a),e=j(t,o),u=Math.abs(k(t,o));let i;if(u<1)i=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-e*u);let r=j(t,o)===-e;B(d(s))&&u===1&&j(s,o)===1&&(r=!1),i=e*(u-Number(r))}return i===0?0:i}function J(s,a,t){const o=Y(s,a)/1e3;return P(t==null?void 0:t.roundingMethod)(o)}function K(s,a,t){const o=T(),e=(t==null?void 0:t.locale)??o.locale??I,u=2520,i=j(s,a);if(isNaN(i))throw new RangeError("Invalid time value");const r=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:i});let f,h;i>0?(f=d(a),h=d(s)):(f=d(s),h=d(a));const m=J(h,f),l=(D(h)-D(f))/1e3,c=Math.round((m-l)/60);let g;if(c<2)return t!=null&&t.includeSeconds?m<5?e.formatDistance("lessThanXSeconds",5,r):m<10?e.formatDistance("lessThanXSeconds",10,r):m<20?e.formatDistance("lessThanXSeconds",20,r):m<40?e.formatDistance("halfAMinute",0,r):m<60?e.formatDistance("lessThanXMinutes",1,r):e.formatDistance("xMinutes",1,r):c===0?e.formatDistance("lessThanXMinutes",1,r):e.formatDistance("xMinutes",c,r);if(c<45)return e.formatDistance("xMinutes",c,r);if(c<90)return e.formatDistance("aboutXHours",1,r);if(c<p){const x=Math.round(c/60);return e.formatDistance("aboutXHours",x,r)}else{if(c<u)return e.formatDistance("xDays",1,r);if(c<b){const x=Math.round(c/p);return e.formatDistance("xDays",x,r)}else if(c<b*2)return g=Math.round(c/b),e.formatDistance("aboutXMonths",g,r)}if(g=Q(h,f),g<12){const x=Math.round(c/b);return e.formatDistance("xMonths",x,r)}else{const x=g%12,M=Math.trunc(g/12);return x<3?e.formatDistance("aboutXYears",M,r):x<9?e.formatDistance("overXYears",M,r):e.formatDistance("almostXYears",M+1,r)}}function U(s,a){return K(s,L(s),a)}const V=async(s,a=1,t=20)=>{const o=(a-1)*t,e=o+t-1,{data:u,error:i,count:r}=await C.from("feedback_responses").select(`
      id,
      created_at,
      response_value,
      question_snapshot
    `,{count:"exact"}).eq("organization_id",s).order("created_at",{ascending:!1}).range(o,e);if(i)throw console.error("Error fetching feedback responses:",i),i;return{data:u,count:r}},G=({organizationId:s})=>{const[a,t]=X.useState(1),o=15,{data:e,isLoading:u,isError:i,error:r}=O({queryKey:["feedbackResponses",s,a,o],queryFn:()=>V(s,a,o),placeholderData:l=>l}),f=e==null?void 0:e.data,h=(e==null?void 0:e.count)??0,m=Math.ceil(h/o);return n.jsxs(R,{children:[n.jsxs(q,{children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(v,{className:"w-6 h-6"}),n.jsx(E,{children:"Feedback Inbox"})]}),n.jsxs(A,{variant:"outline",children:[h," Total Responses"]})]}),n.jsx(F,{children:"View and manage individual feedback submissions."})]}),n.jsxs(H,{children:[n.jsxs("div",{className:"space-y-4",children:[u&&Array.from({length:5}).map((l,c)=>n.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[n.jsx(y,{className:"h-4 w-3/4"}),n.jsx(y,{className:"h-4 w-1/2"}),n.jsx(y,{className:"h-4 w-1/4"})]},c)),i&&n.jsx("div",{className:"text-red-500 p-4 border border-red-200 bg-red-50 rounded-lg",children:n.jsxs("p",{children:["Error loading feedback: ",r instanceof Error?r.message:"An unknown error occurred"]})}),!u&&!i&&f&&f.length>0&&f.map(l=>{var c;return n.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold text-gray-800",children:((c=l.question_snapshot)==null?void 0:c.question_text)||"Question not available"}),n.jsx("p",{className:"text-gray-600 mt-1 text-sm",children:JSON.stringify(l.response_value)})]}),n.jsx("p",{className:"text-xs text-gray-500 whitespace-nowrap pl-4",children:U(new Date(l.created_at),{addSuffix:!0})})]})},l.id)}),!u&&(!f||f.length===0)&&n.jsxs("div",{className:"text-center py-12 text-gray-500",children:[n.jsx(v,{className:"w-12 h-12 mx-auto mb-4"}),n.jsx("p",{className:"font-semibold",children:"Your inbox is empty"}),n.jsx("p",{className:"text-sm",children:"New feedback responses will appear here."})]})]}),m>1&&n.jsxs("div",{className:"flex justify-center items-center space-x-2 mt-6",children:[n.jsx(N,{variant:"outline",onClick:()=>t(l=>Math.max(1,l-1)),disabled:a===1,children:"Previous"}),n.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",a," of ",m]}),n.jsx(N,{variant:"outline",onClick:()=>t(l=>Math.min(m,l+1)),disabled:a===m,children:"Next"})]})]})]})},Z=({organizationId:s})=>n.jsx(G,{organizationId:s});export{Z as default};
