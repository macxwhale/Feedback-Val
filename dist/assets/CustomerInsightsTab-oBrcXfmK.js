import{j as e,C as r,g as l,U as y,L as k,e as c,h as p,P as m,n as C,m as j,aM as _,q as A,t as T,v as x,w as h,d,x as N,p as o,k as u}from"./index-DiVMIM2u.js";import{u as P}from"./useAnalyticsTableData-BeADVGQo.js";import{R,B as L,m as S,X as q,Y as D,T as B,n as G}from"./BarChart-CES-uJUc.js";import{P as z}from"./PermissionGuard-BxLK_hm6.js";const I=({organizationId:n})=>{const{data:t,isLoading:f}=P(n),v=({active:s,payload:a,label:w})=>s&&a&&a.length?e.jsxs("div",{className:"p-4 bg-white/95 backdrop-blur-sm border rounded-xl shadow-xl ring-1 ring-black/5",children:[e.jsx("p",{className:"text-sm text-gray-700 max-w-[200px] break-words font-medium",children:w}),e.jsx("p",{className:"font-bold text-orange-600 text-lg",children:`${a[0].value}% completion`})]}):null;if(f)return e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-10 bg-gradient-to-r from-gray-200 to-gray-300 rounded-lg w-1/3 mb-6"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsx("div",{className:"h-40 bg-gradient-to-br from-gray-200 to-gray-300 rounded-xl"},s))})]})});if(!t)return e.jsx(r,{className:"bg-gradient-to-br from-white via-gray-50/50 to-slate-50/30 backdrop-blur-sm border-2 border-gray-100/50 shadow-xl",children:e.jsxs(l,{className:"p-12 text-center",children:[e.jsx(y,{className:"w-16 h-16 mx-auto mb-6 text-gray-400"}),e.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2",children:"No Customer Insights Available"}),e.jsx("p",{className:"text-gray-500",children:"Start collecting feedback to see detailed customer insights"})]})});const g=t.questions.map(s=>s.completion_rate),b=g.reduce((s,a)=>s+a,0)/g.length,i=t.questions.reduce((s,a)=>(a.completion_rate<80?s.lowCompletion.push(a):a.completion_rate>=90&&s.highPerforming.push(a),a.completion_rate<70&&s.needAttention.push(a),s),{highPerforming:[],needAttention:[],lowCompletion:[]});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 bg-gradient-to-r from-orange-50/80 via-amber-50/60 to-yellow-50/40 backdrop-blur-sm rounded-xl border-2 border-orange-100/50 shadow-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-orange-500 rounded-xl shadow-lg",children:e.jsx(k,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:"Customer Insights"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Deep analysis of customer feedback patterns"})]})]}),e.jsxs(c,{variant:"outline",className:"text-orange-700 border-orange-200 bg-orange-50 px-4 py-2 text-sm font-bold",children:[t.summary.total_responses.toLocaleString()," responses analyzed"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(r,{className:"bg-gradient-to-br from-green-50/80 to-emerald-50/60 backdrop-blur-sm border-2 border-green-200/50 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500 rounded-lg shadow-sm",children:e.jsx(p,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-sm font-bold text-gray-700 uppercase tracking-wider",children:"Avg Completion"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-700",children:[Math.round(b),"%"]}),e.jsx(m,{value:b,className:"h-2"}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Overall performance metric"})]})]})}),e.jsx(r,{className:"bg-gradient-to-br from-blue-50/80 to-indigo-50/60 backdrop-blur-sm border-2 border-blue-200/50 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:e.jsx(C,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-sm font-bold text-gray-700 uppercase tracking-wider",children:"High Performers"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-700",children:i.highPerforming.length}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"questions ≥ 90% completion"}),e.jsxs("div",{className:"text-xs text-blue-600 font-semibold",children:[Math.round(i.highPerforming.length/t.questions.length*100),"% of total"]})]})]})}),e.jsx(r,{className:"bg-gradient-to-br from-red-50/80 to-pink-50/60 backdrop-blur-sm border-2 border-red-200/50 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-500 rounded-lg shadow-sm",children:e.jsx(j,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-sm font-bold text-gray-700 uppercase tracking-wider",children:"Need Attention"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-3xl font-bold text-red-700",children:i.needAttention.length}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"questions < 70% completion"}),e.jsx("div",{className:"text-xs text-red-600 font-semibold",children:"Requires immediate review"})]})]})}),e.jsx(r,{className:"bg-gradient-to-br from-amber-50/80 to-orange-50/60 backdrop-blur-sm border-2 border-amber-200/50 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:e.jsx(_,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-sm font-bold text-gray-700 uppercase tracking-wider",children:"Optimization"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-3xl font-bold text-amber-700",children:i.lowCompletion.length}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"questions < 80% completion"}),e.jsx("div",{className:"text-xs text-amber-600 font-semibold",children:"Improvement opportunities"})]})]})})]}),e.jsxs(A,{defaultValue:"trends",className:"w-full",children:[e.jsxs(T,{className:"grid grid-cols-3 w-full max-w-md mx-auto bg-white/80 backdrop-blur-sm shadow-lg border-2 border-gray-100/50",children:[e.jsx(x,{value:"trends",className:"font-semibold",children:"Performance Trends"}),e.jsx(x,{value:"themes",className:"font-semibold",children:"Key Themes"}),e.jsx(x,{value:"sessions",className:"font-semibold",children:"Session Analysis"})]}),e.jsx(h,{value:"trends",className:"space-y-6 mt-8",children:e.jsxs(r,{className:"bg-gradient-to-br from-white via-gray-50/30 to-slate-50/20 backdrop-blur-sm border-2 border-gray-100/50 shadow-xl",children:[e.jsx(d,{className:"pb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-gray-500 rounded-lg shadow-sm",children:e.jsx(N,{className:"w-5 h-5 text-white"})}),e.jsx(o,{className:"text-xl",children:"Feedback Performance Trends"})]})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-6",children:t.categories.map((s,a)=>e.jsxs("div",{className:"p-6 bg-gradient-to-r from-gray-50/80 to-slate-50/60 rounded-xl border border-gray-200/50 hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 text-lg",children:s.category}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[s.total_questions," questions • ",s.total_responses.toLocaleString()," responses"]})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[s.completion_rate,"%"]}),e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"completion rate"})]})]}),e.jsx(m,{value:s.completion_rate,className:"h-3"})]},a))})})]})}),e.jsx(h,{value:"themes",className:"space-y-6 mt-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(r,{className:"bg-gradient-to-br from-green-50/80 to-emerald-50/60 backdrop-blur-sm border-2 border-green-200/50 shadow-xl",children:[e.jsx(d,{className:"pb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-500 rounded-lg shadow-sm",children:e.jsx(u,{className:"w-5 h-5 text-white"})}),e.jsx(o,{className:"text-green-700 text-xl",children:"High Performing Questions"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[i.highPerforming.slice(0,5).map((s,a)=>e.jsxs("div",{className:"p-4 bg-green-50/80 rounded-xl border-l-4 border-green-500 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-900 mb-2 leading-relaxed",children:s.question_text}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:[s.total_responses.toLocaleString()," responses"]}),e.jsxs(c,{variant:"secondary",className:"bg-green-100 text-green-800 font-bold",children:[s.completion_rate,"%"]})]})]},a)),i.highPerforming.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(u,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"font-medium",children:"No high performing questions yet"}),e.jsx("p",{className:"text-sm",children:"Questions with ≥90% completion will appear here"})]})]})})]}),e.jsxs(r,{className:"bg-gradient-to-br from-red-50/80 to-pink-50/60 backdrop-blur-sm border-2 border-red-200/50 shadow-xl",children:[e.jsx(d,{className:"pb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-red-500 rounded-lg shadow-sm",children:e.jsx(j,{className:"w-5 h-5 text-white"})}),e.jsx(o,{className:"text-red-700 text-xl",children:"Questions Needing Attention"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[i.needAttention.slice(0,5).map((s,a)=>e.jsxs("div",{className:"p-4 bg-red-50/80 rounded-xl border-l-4 border-red-500 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-900 mb-2 leading-relaxed",children:s.question_text}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:[s.total_responses.toLocaleString()," responses"]}),e.jsxs(c,{variant:"secondary",className:"bg-red-100 text-red-800 font-bold",children:[s.completion_rate,"%"]})]})]},a)),i.needAttention.length===0&&e.jsxs("div",{className:"text-center py-8 text-green-600",children:[e.jsx(p,{className:"w-12 h-12 mx-auto mb-3"}),e.jsx("p",{className:"font-bold",children:"All questions performing well!"}),e.jsx("p",{className:"text-sm",children:"No questions below 70% completion rate"})]})]})})]})]})}),e.jsx(h,{value:"sessions",className:"space-y-6 mt-8",children:e.jsxs(r,{className:"bg-gradient-to-br from-white via-blue-50/20 to-indigo-50/10 backdrop-blur-sm border-2 border-blue-100/50 shadow-xl",children:[e.jsx(d,{className:"pb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:e.jsx(N,{className:"w-5 h-5 text-white"})}),e.jsx(o,{className:"text-xl",children:"Session Analysis"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold mb-6 text-gray-900 text-lg",children:"Completion Rate by Question"}),e.jsx("div",{className:"h-[300px] bg-white/60 backdrop-blur-sm rounded-lg p-4 border border-gray-100",children:e.jsx(R,{width:"100%",height:"100%",children:e.jsxs(L,{layout:"vertical",data:t.questions.slice(0,5).map(s=>({name:s.question_text,"Completion Rate":s.completion_rate})),margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(S,{strokeDasharray:"3 3",horizontal:!1}),e.jsx(q,{type:"number",domain:[0,100],unit:"%"}),e.jsx(D,{dataKey:"name",type:"category",width:60,tickLine:!1,axisLine:!1,tickFormatter:s=>s.length>15?`${s.substring(0,15)}...`:s}),e.jsx(B,{content:e.jsx(v,{}),cursor:{fill:"rgba(249, 115, 22, 0.1)"}}),e.jsx(G,{dataKey:"Completion Rate",fill:"url(#completionGradient)",barSize:20,radius:[0,4,4,0]}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"completionGradient",x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"#f97316"}),e.jsx("stop",{offset:"100%",stopColor:"#ea580c"})]})})]})})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold mb-6 text-gray-900 text-lg",children:"Response Distribution"}),e.jsx("div",{className:"space-y-4",children:t.categories.map((s,a)=>e.jsxs("div",{className:"p-4 bg-white/60 backdrop-blur-sm rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.category}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:s.total_responses.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(m,{value:s.total_responses/t.summary.total_responses*100,className:"flex-1 h-3"}),e.jsxs("span",{className:"text-xs font-bold text-gray-600 min-w-[3rem] text-right",children:[Math.round(s.total_responses/t.summary.total_responses*100),"%"]})]})]},a))})]})]})})]})})]})]})},U=({organizationId:n})=>e.jsx(z,{permission:"view_analytics",organizationId:n,showRequiredRole:!0,fallback:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"You need viewer-level access or higher to view customer insights."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your organization administrator for access."})]}),children:e.jsx(I,{organizationId:n})});export{U as CustomerInsightsTab,U as default};
