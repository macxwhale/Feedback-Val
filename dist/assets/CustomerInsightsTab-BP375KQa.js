import{j as e,F as b,C as t,l as r,U as u,H as _,E as C,p as g,i as l,w as M,x as T,y as j,z as p,k as i,q as d,a4 as c}from"./index-Cu1LIOfH.js";import{u as E}from"./useAnalyticsTableData-B6ujuTNU.js";import{P as R}from"./PermissionGuard-Dwb9GcSc.js";const S=({organizationId:m})=>{const{data:s,isLoading:N}=E(m);if(N)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-2 animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-96 animate-pulse"})]}),e.jsx("div",{className:"h-10 bg-gray-200 rounded w-32 animate-pulse"})]}),e.jsx(b,{columns:{xs:1,sm:2,md:2,lg:4},gap:"md",children:Array.from({length:4}).map((a,h)=>e.jsx(t,{children:e.jsxs(r,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mb-2 animate-pulse"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-16 mb-2 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 animate-pulse"})]})},h))})]});if(!s||s.summary.total_responses===0)return e.jsx(t,{children:e.jsxs(r,{className:"p-6 text-center",children:[e.jsx(u,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"No customer insights data available"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Customer insights will appear here once you have feedback responses."})]})});const n=s.summary.total_sessions,o=s.summary.completed_sessions,v=Math.round(o*.6),y=Math.round(o*.4),f=n-o,x=n>0?Math.round(s.summary.total_responses/n):0,w=[{title:"Total Customers",value:s.summary.total_responses||0,change:s.summary.growth_rate||0,trend:(s.summary.growth_rate||0)>=0?"up":"down",icon:u,description:"Unique feedback participants"},{title:"Engagement Rate",value:`${s.summary.overall_completion_rate||0}%`,change:Math.max(0,Math.min(20,s.summary.overall_completion_rate-70)),trend:s.summary.overall_completion_rate>70?"up":"down",icon:_,description:"Session completion rate"},{title:"Avg. Questions Answered",value:x,change:Math.max(0,x-3),trend:x>3?"up":"down",icon:C,description:"Questions per session"},{title:"Customer Satisfaction",value:`${s.summary.user_satisfaction_rate||0}%`,change:Math.max(0,Math.min(25,(s.summary.user_satisfaction_rate||0)-60)),trend:(s.summary.user_satisfaction_rate||0)>60?"up":"down",icon:g,description:"Overall satisfaction rate"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Customer Insights"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Deep dive into customer behavior and engagement patterns"})]}),e.jsxs(l,{variant:"outline",className:"flex items-center space-x-2 self-start sm:self-auto",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs",children:"Real-time Data"})]})]}),e.jsx(b,{columns:{xs:1,sm:2,md:2,lg:4},gap:"md",children:w.map((a,h)=>e.jsx(t,{className:"hover:shadow-md transition-shadow duration-200",children:e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(a.icon,{className:"w-4 h-4 text-blue-600"})}),e.jsxs(l,{variant:a.trend==="up"?"default":"destructive",className:"text-xs",children:[a.trend==="up"?"+":"",a.change,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:a.title}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:a.value}),e.jsx("p",{className:"text-xs text-gray-500",children:a.description})]})]})},h))}),e.jsxs(M,{defaultValue:"segments",className:"w-full",children:[e.jsxs(T,{className:"grid w-full max-w-lg grid-cols-3",children:[e.jsx(j,{value:"segments",children:"Segments"}),e.jsx(j,{value:"journey",children:"Journey"}),e.jsx(j,{value:"behavior",children:"Behavior"})]}),e.jsx(p,{value:"segments",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsxs(d,{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{children:"Customer Segments"})]}),e.jsx(c,{children:"Breakdown of customers by engagement level"})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg border-l-4 border-green-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Highly Engaged"}),e.jsx("p",{className:"text-xs text-green-600",children:"Completed 80%+ of sessions"})]}),e.jsx(l,{className:"bg-green-100 text-green-800",children:v})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Moderately Engaged"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Completed 50-80% of sessions"})]}),e.jsx(l,{className:"bg-blue-100 text-blue-800",children:y})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-orange-50 rounded-lg border-l-4 border-orange-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-orange-800",children:"Low Engagement"}),e.jsx("p",{className:"text-xs text-orange-600",children:"Completed less than 50%"})]}),e.jsx(l,{className:"bg-orange-100 text-orange-800",children:f})]})]})})]}),e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsxs(d,{className:"flex items-center space-x-2",children:[e.jsx(g,{className:"w-5 h-5"}),e.jsx("span",{children:"Engagement Trends"})]}),e.jsx(c,{children:"Customer engagement over time"})]}),e.jsx(r,{children:e.jsx("div",{className:"h-48 flex items-center justify-center border-2 border-dashed border-gray-200 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Engagement Chart"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Trend visualization will appear here"})]})})})]})]})}),e.jsx(p,{value:"journey",className:"space-y-6 mt-6",children:e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsx(d,{children:"Customer Journey Analysis"}),e.jsx(c,{children:"Understanding how customers navigate through feedback sessions"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:n}),e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Started Sessions"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Initial engagement"})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-2",children:Math.round(n*.75)}),e.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"Mid-Session"}),e.jsx("p",{className:"text-xs text-yellow-600",children:"Continued engagement"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:o}),e.jsx("p",{className:"text-sm text-green-800 font-medium",children:"Completed"}),e.jsx("p",{className:"text-xs text-green-600",children:"Full journey completion"})]})]})})})]})}),e.jsx(p,{value:"behavior",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsx(d,{children:"Response Patterns"}),e.jsx(c,{children:"How customers interact with different question types"})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Multiple Choice"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Quick selections"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[s.summary.overall_completion_rate,"%"]}),e.jsx("div",{className:"text-xs text-green-600",children:"Response rate"})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Rating Scales"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Numerical feedback"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[Math.max(0,s.summary.overall_completion_rate-5),"%"]}),e.jsx("div",{className:"text-xs text-green-600",children:"Response rate"})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Open Text"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Written responses"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[Math.max(0,s.summary.overall_completion_rate-15),"%"]}),e.jsx("div",{className:"text-xs text-yellow-600",children:"Response rate"})]})]})]})})]}),e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsx(d,{children:"Key Insights"}),e.jsx(c,{children:"Actionable insights from customer behavior"})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-blue-800",children:["📈 ",s.summary.user_satisfaction_rate>70?"High satisfaction scores indicate strong customer sentiment":"Focus on improving satisfaction scores"]})}),e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-green-800",children:["✅ ",x>5?"Customers are highly engaged with longer sessions":"Consider shorter, focused question sets"]})}),e.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-amber-800",children:["⚠️ ",s.summary.overall_completion_rate<70?"Completion rate needs improvement - simplify questions":"Good completion rates maintained"]})}),e.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-purple-800",children:["🎯 ",s.summary.growth_rate>0?`Growing ${s.summary.growth_rate}% - maintain momentum`:"Focus on customer acquisition strategies"]})})]})})]})]})})]})]})},D=({organizationId:m})=>e.jsx(R,{permission:"view_analytics",organizationId:m,showRequiredRole:!0,fallback:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"You need viewer-level access or higher to view customer insights."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your organization administrator for access."})]}),children:e.jsx(S,{organizationId:m})});export{D as CustomerInsightsTab,D as default};
