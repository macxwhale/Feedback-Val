import{c as p,j as e,C as c,l as o,aY as g,p as S,A as T,i as x,k as b,q as f,T as A,m as M,w as R,x as $,y,z as j}from"./index-DtITnSs2.js";import{u as B}from"./useAnalyticsTableData-DUNSlTRz.js";import{T as q}from"./trending-down-BamMDA1W.js";import{P as D}from"./PermissionGuard-Bidju3m9.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=p("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=p("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=p("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),P=({sentimentStats:t,totalQuestions:s,overallScore:l})=>{if(s===0)return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e.jsx(c,{className:"hover:shadow-md transition-shadow duration-200",children:e.jsxs(o,{className:"p-6 text-center",children:[e.jsx(g,{className:"w-8 h-8 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No sentiment data available"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Sentiment analysis will appear once you have feedback responses."})]})})});const i=t.positive>t.negative?"positive":t.negative>t.positive?"negative":"neutral",r=[{title:"Overall Sentiment",value:i,count:s,icon:g,color:i==="positive"?"text-green-600":i==="negative"?"text-red-600":"text-yellow-600",bgColor:i==="positive"?"bg-green-50":i==="negative"?"bg-red-50":"bg-yellow-50",description:"Dominant sentiment across all questions"},{title:"Positive Responses",value:t.positive,percentage:s>0?Math.round(t.positive/s*100):0,icon:S,color:"text-green-600",bgColor:"bg-green-50",description:"Questions with positive feedback trends"},{title:"Negative Responses",value:t.negative,percentage:s>0?Math.round(t.negative/s*100):0,icon:q,color:"text-red-600",bgColor:"bg-red-50",description:"Questions requiring attention"},{title:"Neutral Responses",value:t.neutral,percentage:s>0?Math.round(t.neutral/s*100):0,icon:T,color:"text-gray-600",bgColor:"bg-gray-50",description:"Balanced or mixed sentiment"}];return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map((a,d)=>e.jsx(c,{className:"hover:shadow-md transition-shadow duration-200",children:e.jsxs(o,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.bgColor}`,children:e.jsx(a.icon,{className:`w-4 h-4 ${a.color}`})}),a.percentage!==void 0&&e.jsxs(x,{variant:"outline",className:"text-xs",children:[a.percentage,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:a.title}),e.jsx("div",{className:`text-2xl font-bold mb-1 ${a.color}`,children:(typeof a.value=="string",a.value)}),e.jsx("p",{className:"text-xs text-gray-500",children:a.description})]})]})},d))})},w=({sentiment:t,className:s="w-4 h-4"})=>{switch(t){case"positive":return e.jsx(O,{className:`${s} text-green-600`});case"negative":return e.jsx(L,{className:`${s} text-red-600`});case"neutral":return e.jsx(N,{className:`${s} text-yellow-600`});default:return e.jsx(N,{className:`${s} text-gray-600`})}},v=t=>{switch(t){case"positive":return"bg-green-100 text-green-800 border-green-200";case"negative":return"bg-red-100 text-red-800 border-red-200";case"neutral":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},F=t=>{const s=t.filter(r=>r.sentiment==="positive").length,l=t.filter(r=>r.sentiment==="negative").length,i=t.filter(r=>r.sentiment==="neutral").length;return{positive:s,negative:l,neutral:i}},Y=t=>t.positive>t.negative&&t.positive>t.neutral?"positive":t.negative>t.positive&&t.negative>t.neutral?"negative":"neutral",z=({questionSentiments:t})=>e.jsxs(c,{children:[e.jsx(b,{children:e.jsx(f,{children:"Question Sentiment Analysis"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:t.map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(w,{sentiment:s.sentiment}),e.jsx(x,{className:v(s.sentiment),children:s.sentiment})]}),e.jsx("h4",{className:"font-medium text-sm",children:s.question_text}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.total_responses," responses • ",s.completion_rate,"% completion"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[s.completion_rate,"%"]}),s.sentiment==="negative"&&e.jsx(A,{className:"w-4 h-4 text-red-500 ml-auto mt-1"}),s.sentiment==="positive"&&e.jsx(M,{className:"w-4 h-4 text-green-500 ml-auto mt-1"})]})]},l))})})]}),E=({categorySentiments:t})=>e.jsxs(c,{children:[e.jsx(b,{children:e.jsx(f,{children:"Category Sentiment Analysis"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:t.map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(w,{sentiment:s.sentiment}),e.jsx(x,{className:v(s.sentiment),children:s.sentiment})]}),e.jsx("h4",{className:"font-medium",children:s.category}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.total_questions," questions • ",s.total_responses," responses"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold",children:s.total_responses}),e.jsx("div",{className:"text-sm text-gray-500",children:"responses"})]})]},l))})})]}),G=({organizationId:t})=>{const{data:s,isLoading:l}=B(t);if(l)return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(n=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},n))})]})});if(!s)return e.jsx(c,{children:e.jsxs(o,{className:"p-6 text-center",children:[e.jsx(g,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"No sentiment data available"})]})});const i=s.questions.map(n=>{const m=n.trend==="positive"?"positive":n.trend==="negative"?"negative":"neutral";return{...n,sentiment:m}}),r=F(i),a=i.length,d=Y(r),C=s.categories.map(n=>{const m=n.questions.filter(k=>k.trend==="positive").length,h=n.questions.length,u=h>0?m/h:0,_=u>.6?"positive":u<.3?"negative":"neutral";return{...n,sentiment:_}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Sentiment Analysis"}),e.jsxs(x,{className:v(d),children:["Overall: ",d]})]}),e.jsx(P,{sentimentStats:r,totalQuestions:a,overallScore:0}),e.jsxs(R,{defaultValue:"questions",className:"w-full",children:[e.jsxs($,{className:"grid grid-cols-2 w-full max-w-md",children:[e.jsx(y,{value:"questions",children:"By Question"}),e.jsx(y,{value:"categories",children:"By Category"})]}),e.jsx(j,{value:"questions",className:"space-y-4",children:e.jsx(z,{questionSentiments:i.map(n=>({question_text:n.question_text,sentiment:n.sentiment,total_responses:n.total_responses,completion_rate:n.completion_rate}))})}),e.jsx(j,{value:"categories",className:"space-y-4",children:e.jsx(E,{categorySentiments:C.map(n=>({category:n.category,sentiment:n.sentiment,total_questions:n.total_questions,total_responses:n.total_responses}))})})]})]})},V=({organizationId:t})=>e.jsx(D,{permission:"view_analytics",organizationId:t,showRequiredRole:!0,fallback:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"You need viewer-level access or higher to view sentiment analysis."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your organization administrator for access."})]}),children:e.jsx(G,{organizationId:t})});export{V as SentimentTab,V as default};
