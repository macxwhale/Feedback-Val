import{c as b,s as f,r as g,u as y,j as e,C as N,a as v,b as w,B as k,d as _,e as C,S as h,f as q,g as p,P}from"./index-DU5CaqlN.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=b("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]),E=async(t,r=1,i=20)=>{const n=(r-1)*i,a=n+i-1,{data:o,error:c,count:d}=await f.from("feedback_responses").select(`
      id,
      created_at,
      response_value,
      question_snapshot
    `,{count:"exact"}).eq("organization_id",t).order("created_at",{ascending:!1}).range(n,a);if(c)throw console.error("Error fetching feedback responses:",c),c;return{data:o,count:d}},R=({organizationId:t})=>{const[r,i]=g.useState(1),n=15,{data:a,isLoading:o,isError:c,error:d}=y({queryKey:["feedbackResponses",t,r,n],queryFn:()=>E(t,r,n),placeholderData:s=>s}),l=a==null?void 0:a.data,u=(a==null?void 0:a.count)??0,x=Math.ceil(u/n);return e.jsxs(N,{children:[e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{className:"w-6 h-6"}),e.jsx(w,{children:"Feedback Inbox"})]}),e.jsxs(k,{variant:"outline",children:[u," Total Responses"]})]}),e.jsx(_,{children:"View and manage individual feedback submissions."})]}),e.jsxs(C,{children:[e.jsxs("div",{className:"space-y-4",children:[o&&Array.from({length:5}).map((s,m)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[e.jsx(h,{className:"h-4 w-3/4"}),e.jsx(h,{className:"h-4 w-1/2"}),e.jsx(h,{className:"h-4 w-1/4"})]},m)),c&&e.jsx("div",{className:"text-red-500 p-4 border border-red-200 bg-red-50 rounded-lg",children:e.jsxs("p",{children:["Error loading feedback: ",d instanceof Error?d.message:"An unknown error occurred"]})}),!o&&!c&&l&&l.length>0&&l.map(s=>{var m;return e.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:((m=s.question_snapshot)==null?void 0:m.question_text)||"Question not available"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm",children:JSON.stringify(s.response_value)})]}),e.jsx("p",{className:"text-xs text-gray-500 whitespace-nowrap pl-4",children:q(new Date(s.created_at),{addSuffix:!0})})]})},s.id)}),!o&&(!l||l.length===0)&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(j,{className:"w-12 h-12 mx-auto mb-4"}),e.jsx("p",{className:"font-semibold",children:"Your inbox is empty"}),e.jsx("p",{className:"text-sm",children:"New feedback responses will appear here."})]})]}),x>1&&e.jsxs("div",{className:"flex justify-center items-center space-x-2 mt-6",children:[e.jsx(p,{variant:"outline",onClick:()=>i(s=>Math.max(1,s-1)),disabled:r===1,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",r," of ",x]}),e.jsx(p,{variant:"outline",onClick:()=>i(s=>Math.min(x,s+1)),disabled:r===x,children:"Next"})]})]})]})},D=({organizationId:t})=>e.jsx(P,{permission:"view_analytics",organizationId:t,showRequiredRole:!0,fallback:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"You need viewer-level access or higher to view the feedback inbox."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your organization administrator for access."})]}),children:e.jsx(R,{organizationId:t})});export{D as default};
