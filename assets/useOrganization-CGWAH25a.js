import{r as t,ax as h,ay as w,az as S,aA as r}from"./index-Ccnl8v9s.js";const E=()=>{const[f,l]=t.useState(null),[m,s]=t.useState(!0),[z,c]=t.useState(null),i=h(),u=w();return t.useEffect(()=>{(async()=>{const g=u.pathname;console.log("useOrganization - Starting detection for path:",g),s(!0),c(null),l(null);let o=null;const n=i.orgSlug||i.slug,d=["admin","auth","login","create-organization","terms-of-service","privacy-policy"];if(n&&d.includes(n)){console.log(`useOrganization - Path matched special route "${n}", skipping org detection.`),s(!1);return}const e=new URL(window.location.href).hostname;if(e!=="localhost"&&!e.includes("lovable.app")&&!e.includes("lovableproject.com")){console.log("useOrganization - Checking domain:",e);try{o=await S(e),console.log("useOrganization - Domain result:",o)}catch(a){console.warn("useOrganization - Domain check failed:",a)}}if(!o&&e.includes(".")){const a=e.split(".")[0];if(a!=="www"&&a!=="feedback"&&!a.includes("preview--")){console.log("useOrganization - Checking subdomain:",a);try{o=await r(a),console.log("useOrganization - Subdomain result:",o)}catch(O){console.warn("useOrganization - Subdomain check failed:",O)}}}if(!o&&n){console.log("useOrganization - Checking slug from params:",n);try{o=await r(n),console.log("useOrganization - Slug result:",o)}catch(a){console.error("useOrganization - Slug check failed:",a)}}if(!o&&g==="/"){console.log("useOrganization - No org found, defaulting to police-sacco for root path");try{o=await r("police-sacco"),console.log("useOrganization - Default police-sacco result:",o)}catch(a){console.error("useOrganization - Default police-sacco failed:",a)}}l(o);const p=n&&!d.includes(n);!o&&p&&(console.log("useOrganization - No organization found for slug:",n),c("Organization not found")),s(!1),console.log("useOrganization - Detection finished. Final org:",(o==null?void 0:o.name)||"none")})()},[i.slug,i.orgSlug,u.pathname]),{organization:f,isLoading:m,error:z}};export{E as u};
