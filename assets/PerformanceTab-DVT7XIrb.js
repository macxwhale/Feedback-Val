import{c as f,j as e,C as d,l as x,H as N,k as _,q as j,i as v,T as y,G as b,w,x as T,y as h,z as g}from"./index-QjVmUwmy.js";import{u as C}from"./useAnalyticsTableData-B4srsXWM.js";import{P}from"./progress-DGjLfjEu.js";import{P as R}from"./PermissionGuard-BtriJEFJ.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=f("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=f("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=f("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),S=({performanceInsights:s,totalQuestions:t})=>{const m=(()=>{if(t===0||s.totalResponses===0)return 0;const l=s.avgCompletionRate,i=Math.max(0,100-s.avgResponseTime/100),a=t>0?s.fastRespondingQuestions/t*100:0,c=l*.4+i*.3+a*.3;return Math.round(Math.min(100,Math.max(0,c)))})();return e.jsx("div",{className:"grid grid-cols-1 max-w-2xl mx-auto",children:e.jsx(d,{className:"hover:shadow-lg transition-shadow duration-200",children:e.jsxs(x,{className:"p-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(N,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{className:"text-base font-semibold text-gray-700",children:"Overall Performance Score"})]})}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-4",children:[m,"%"]}),e.jsx("div",{className:"text-sm text-gray-500 leading-relaxed",children:t===0||s.totalResponses===0?"Performance score will appear once you have feedback responses.":"Composite score measuring response speed, completion rates, and user engagement across all feedback sessions."})]})})})},Q=({topPerformers:s})=>e.jsxs(d,{children:[e.jsx(_,{children:e.jsx(j,{className:"text-green-600",children:"Fastest Answered Questions"})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:s.length>0?s.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg border-l-4 border-green-500",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs(v,{className:"bg-green-100 text-green-800",children:["#",r+1]}),e.jsx(k,{className:"w-4 h-4 text-green-600"})]}),e.jsx("h4",{className:"font-medium text-sm",children:t.question_text}),e.jsxs("p",{className:"text-xs text-gray-600",children:[t.total_responses," responses â€¢ ",t.completion_rate,"% completion"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[((t.avg_response_time_ms||0)/1e3).toFixed(1),"s"]}),e.jsx(M,{className:"w-4 h-4 text-green-500 ml-auto mt-1"})]})]},r)):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No response time data yet."})})})]}),L=({lowPerformers:s})=>e.jsxs(d,{children:[e.jsx(_,{children:e.jsx(j,{className:"text-red-600",children:"Slowest Answered Questions"})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:s.length>0?s.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-50 rounded-lg border-l-4 border-red-500",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(y,{className:"w-4 h-4 text-red-600"}),e.jsx(v,{className:"bg-red-100 text-red-800",children:"Needs Attention"})]}),e.jsx("h4",{className:"font-medium text-sm",children:t.question_text}),e.jsxs("p",{className:"text-xs text-gray-600",children:[t.total_responses," responses â€¢ ",t.completion_rate,"% completion"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-red-600",children:[((t.avg_response_time_ms||0)/1e3).toFixed(1),"s"]}),e.jsx(A,{className:"w-4 h-4 text-red-500 ml-auto mt-1"})]})]},r)):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No questions with slow response times found! ðŸŽ‰"})})})]}),F=s=>{if(!s||s.length===0)return{topPerformers:[],lowPerformers:[],completionTrends:[]};const t=[...s].filter(a=>a.avg_response_time_ms&&a.avg_response_time_ms>0).sort((a,c)=>(a.avg_response_time_ms||0)-(c.avg_response_time_ms||0)),r=t.slice(0,5).map(a=>({question_text:a.question_text,avg_score:a.avg_score,total_responses:a.total_responses,completion_rate:a.completion_rate,avg_response_time_ms:a.avg_response_time_ms})),l=t.filter(a=>(a.avg_response_time_ms||0)>15e3).slice(-5).reverse().map(a=>({question_text:a.question_text,avg_score:a.avg_score,total_responses:a.total_responses,completion_rate:a.completion_rate,avg_response_time_ms:a.avg_response_time_ms})),i=[...s].sort((a,c)=>c.completion_rate-a.completion_rate).map(a=>({question_text:a.question_text,completion_rate:a.completion_rate,total_responses:a.total_responses}));return{topPerformers:r,lowPerformers:l,completionTrends:i}},H=(s,t)=>{if(!s||s.length===0)return{fastRespondingQuestions:0,slowRespondingQuestions:0,avgCompletionRate:0,totalResponses:0,avgResponseTime:0};const r=1e4,m=3e4,l=s.filter(o=>o.avg_response_time_ms&&o.avg_response_time_ms>0),i=l.filter(o=>(o.avg_response_time_ms||0)<=r).length,a=l.filter(o=>(o.avg_response_time_ms||0)>=m).length,c=s.reduce((o,p)=>o+p.total_responses,0),n=s.length>0?s.reduce((o,p)=>o+p.completion_rate,0)/s.length:0,u=l.length>0?l.reduce((o,p)=>o+(p.avg_response_time_ms||0),0)/l.length:0;return{fastRespondingQuestions:i,slowRespondingQuestions:a,avgCompletionRate:Math.round(n),totalResponses:c,avgResponseTime:Math.round(u)}},z=s=>s<=1e4?"text-green-600":s<=2e4?"text-yellow-600":"text-red-600",D=s=>s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",V=({completionTrends:s})=>e.jsxs(d,{children:[e.jsx(_,{children:e.jsx(j,{children:"Completion Rate Analysis"})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:s.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:t.question_text}),e.jsxs("p",{className:"text-xs text-gray-600",children:[t.total_responses," responses"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-sm font-bold ${D(t.completion_rate)}`,children:[t.completion_rate,"%"]})}),e.jsx(P,{value:t.completion_rate,className:"w-20 h-2"})]})]},r))})})]}),B=({categoryPerformance:s})=>e.jsxs(d,{children:[e.jsx(_,{children:e.jsx(j,{children:"Category Performance"})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:s.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsxs(v,{variant:"outline",children:["#",r+1]})}),e.jsx("h4",{className:"font-medium",children:t.category}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.total_questions," questions â€¢ ",t.total_responses," responses"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-xl font-bold ${z(t.avg_response_time_ms||0)}`,children:[((t.avg_response_time_ms||0)/1e3).toFixed(1),"s"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.completion_rate,"% completion"]})]})]},r))})})]}),G=({organizationId:s})=>{const{data:t,isLoading:r}=C(s);if(r)return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(n=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},n))})]})});if(!t)return e.jsx(d,{children:e.jsxs(x,{className:"p-6 text-center",children:[e.jsx(b,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"No performance data available"})]})});const{topPerformers:m,lowPerformers:l,completionTrends:i}=F(t.questions),a=H(t.questions,t.summary),c=[...t.categories].sort((n,u)=>(n.avg_response_time_ms||0)-(u.avg_response_time_ms||0));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Performance Analytics"}),e.jsxs(v,{variant:"outline",children:[t.summary.total_questions," questions analyzed"]})]}),e.jsx(S,{performanceInsights:a,totalQuestions:t.summary.total_questions}),e.jsxs(w,{defaultValue:"top-performers",className:"w-full",children:[e.jsxs(T,{className:"grid grid-cols-4 w-full max-w-2xl",children:[e.jsx(h,{value:"top-performers",children:"Top Performers"}),e.jsx(h,{value:"low-performers",children:"Need Attention"}),e.jsx(h,{value:"completion",children:"Completion"}),e.jsx(h,{value:"categories",children:"Categories"})]}),e.jsx(g,{value:"top-performers",className:"space-y-4",children:e.jsx(Q,{topPerformers:m})}),e.jsx(g,{value:"low-performers",className:"space-y-4",children:e.jsx(L,{lowPerformers:l})}),e.jsx(g,{value:"completion",className:"space-y-4",children:e.jsx(V,{completionTrends:i})}),e.jsx(g,{value:"categories",className:"space-y-4",children:e.jsx(B,{categoryPerformance:c.map(n=>({category:n.category,avg_score:n.avg_score,total_questions:n.total_questions,total_responses:n.total_responses,completion_rate:n.completion_rate,avg_response_time_ms:n.avg_response_time_ms}))})})]})]})},Y=({organizationId:s})=>e.jsx(R,{permission:"view_analytics",organizationId:s,showRequiredRole:!0,fallback:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"You need viewer-level access or higher to view performance analytics."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your organization administrator for access."})]}),children:e.jsx(G,{organizationId:s})});export{Y as PerformanceTab,Y as default};
