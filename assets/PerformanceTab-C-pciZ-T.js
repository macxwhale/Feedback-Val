import{c as v,j as e,C as c,l as o,H as f,k as h,q as j,i as g,T as N,G as _,w as y,x as b,y as x,z as p}from"./index-fQWeZZOi.js";import{u as w}from"./useAnalyticsTableData-DkgF2xON.js";import{P as T}from"./progress-CC4MC0xq.js";import{P as C}from"./PermissionGuard-C9eqQtiY.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=v("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=v("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=v("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),R=({performanceInsights:t,totalQuestions:s})=>e.jsx("div",{className:"grid grid-cols-1 max-w-2xl mx-auto",children:e.jsx(c,{className:"hover:shadow-lg transition-shadow duration-200",children:e.jsxs(o,{className:"p-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(f,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{className:"text-base font-semibold text-gray-700",children:"Overall Performance Score"})]})}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-4",children:[Math.round((t.avgCompletionRate+(5e3-t.avgResponseTime)/50)/2),"%"]}),e.jsx("div",{className:"text-sm text-gray-500 leading-relaxed",children:"Composite score measuring response speed, completion rates, and user engagement across all feedback sessions."})]})})}),Q=({topPerformers:t})=>e.jsxs(c,{children:[e.jsx(h,{children:e.jsx(j,{className:"text-green-600",children:"Fastest Answered Questions"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:t.length>0?t.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg border-l-4 border-green-500",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs(g,{className:"bg-green-100 text-green-800",children:["#",a+1]}),e.jsx(P,{className:"w-4 h-4 text-green-600"})]}),e.jsx("h4",{className:"font-medium text-sm",children:s.question_text}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.total_responses," responses â€¢ ",s.completion_rate,"% completion"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[((s.avg_response_time_ms||0)/1e3).toFixed(1),"s"]}),e.jsx(k,{className:"w-4 h-4 text-green-500 ml-auto mt-1"})]})]},a)):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No response time data yet."})})})]}),L=({lowPerformers:t})=>e.jsxs(c,{children:[e.jsx(h,{children:e.jsx(j,{className:"text-red-600",children:"Slowest Answered Questions"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:t.length>0?t.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-50 rounded-lg border-l-4 border-red-500",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(N,{className:"w-4 h-4 text-red-600"}),e.jsx(g,{className:"bg-red-100 text-red-800",children:"Needs Attention"})]}),e.jsx("h4",{className:"font-medium text-sm",children:s.question_text}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.total_responses," responses â€¢ ",s.completion_rate,"% completion"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-red-600",children:[((s.avg_response_time_ms||0)/1e3).toFixed(1),"s"]}),e.jsx(A,{className:"w-4 h-4 text-red-500 ml-auto mt-1"})]})]},a)):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No questions with slow response times found! ðŸŽ‰"})})})]}),M=t=>{const s=[...t].sort((l,i)=>(l.avg_response_time_ms||1/0)-(i.avg_response_time_ms||1/0)),a=s.slice(0,5).filter(l=>l.avg_response_time_ms),m=s.slice(-5).filter(l=>l.avg_response_time_ms),d=[...t].sort((l,i)=>(i.completion_rate||0)-(l.completion_rate||0)).slice(0,10);return{topPerformers:a,lowPerformers:m,completionTrends:d}},F=(t,s)=>{const a=t.filter(n=>n.avg_response_time_ms),m=a.filter(n=>(n.avg_response_time_ms||0)<3e3).length,d=a.filter(n=>(n.avg_response_time_ms||0)>1e4).length,l=t.length>0?t.reduce((n,r)=>n+(r.completion_rate||0),0)/t.length:0,i=a.length>0?a.reduce((n,r)=>n+(r.avg_response_time_ms||0),0)/a.length:0;return{fastRespondingQuestions:m,slowRespondingQuestions:d,avgCompletionRate:l,totalResponses:s.total_responses||0,avgResponseTime:i}},H=t=>t<3e3?"text-green-600":t<7e3?"text-yellow-600":"text-red-600",q=t=>t>=80?"text-green-600":t>=60?"text-yellow-600":"text-red-600",z=({completionTrends:t})=>e.jsxs(c,{children:[e.jsx(h,{children:e.jsx(j,{children:"Completion Rate Analysis"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:t.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:s.question_text}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.total_responses," responses"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-sm font-bold ${q(s.completion_rate)}`,children:[s.completion_rate,"%"]})}),e.jsx(T,{value:s.completion_rate,className:"w-20 h-2"})]})]},a))})})]}),D=({categoryPerformance:t})=>e.jsxs(c,{children:[e.jsx(h,{children:e.jsx(j,{children:"Category Performance"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:t.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsxs(g,{variant:"outline",children:["#",a+1]})}),e.jsx("h4",{className:"font-medium",children:s.category}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.total_questions," questions â€¢ ",s.total_responses," responses"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-xl font-bold ${H(s.avg_response_time_ms||0)}`,children:[((s.avg_response_time_ms||0)/1e3).toFixed(1),"s"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.completion_rate,"% completion"]})]})]},a))})})]}),I=({organizationId:t})=>{const{data:s,isLoading:a}=w(t);if(a)return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(r=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},r))})]})});if(!s)return e.jsx(c,{children:e.jsxs(o,{className:"p-6 text-center",children:[e.jsx(_,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"No performance data available"})]})});const{topPerformers:m,lowPerformers:d,completionTrends:l}=M(s.questions),i=F(s.questions,s.summary),n=[...s.categories].sort((r,u)=>(r.avg_response_time_ms||0)-(u.avg_response_time_ms||0));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Performance Analytics"}),e.jsxs(g,{variant:"outline",children:[s.summary.total_questions," questions analyzed"]})]}),e.jsx(R,{performanceInsights:i,totalQuestions:s.summary.total_questions}),e.jsxs(y,{defaultValue:"top-performers",className:"w-full",children:[e.jsxs(b,{className:"grid grid-cols-4 w-full max-w-2xl",children:[e.jsx(x,{value:"top-performers",children:"Top Performers"}),e.jsx(x,{value:"low-performers",children:"Need Attention"}),e.jsx(x,{value:"completion",children:"Completion"}),e.jsx(x,{value:"categories",children:"Categories"})]}),e.jsx(p,{value:"top-performers",className:"space-y-4",children:e.jsx(Q,{topPerformers:m})}),e.jsx(p,{value:"low-performers",className:"space-y-4",children:e.jsx(L,{lowPerformers:d})}),e.jsx(p,{value:"completion",className:"space-y-4",children:e.jsx(z,{completionTrends:l})}),e.jsx(p,{value:"categories",className:"space-y-4",children:e.jsx(D,{categoryPerformance:n.map(r=>({category:r.category,avg_score:r.avg_score,total_questions:r.total_questions,total_responses:r.total_responses,completion_rate:r.completion_rate,avg_response_time_ms:r.avg_response_time_ms}))})})]})]})},S=({organizationId:t})=>e.jsx(C,{permission:"view_analytics",organizationId:t,showRequiredRole:!0,fallback:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"You need viewer-level access or higher to view performance analytics."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your organization administrator for access."})]}),children:e.jsx(I,{organizationId:t})});export{S as PerformanceTab,S as default};
