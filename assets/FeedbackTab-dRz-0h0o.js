import{g as S,j as e,C as l,d,e as o,a as c,X as m,a3 as T,Z as j,_ as p,$ as g,a0 as u,a4 as k,Y as A,a2 as f,s as h}from"./index-brczihPD.js";const R=({organizationId:a})=>{const{data:s,isLoading:y}=S({queryKey:["organization-specific-stats",a],queryFn:async()=>{const[t,n,i]=await Promise.all([h.from("feedback_responses").select("id, created_at, score").eq("organization_id",a),h.from("feedback_sessions").select("id, status, created_at, total_score").eq("organization_id",a),h.from("organization_users").select("id, created_at, status").eq("organization_id",a)]);return{responses:t.data||[],sessions:n.data||[],members:i.data||[]}},enabled:!!a});if(y)return e.jsx("div",{className:"p-8",children:"Loading organization statistics..."});const b=(s==null?void 0:s.sessions.filter(t=>t.status==="active").length)||0,N=(s==null?void 0:s.sessions.filter(t=>t.status==="completed").length)||0,v=(s==null?void 0:s.members.filter(t=>t.status==="active").length)||0,C=(s==null?void 0:s.responses.reduce((t,n)=>{const i=new Date(n.created_at).toLocaleString("default",{month:"short",year:"2-digit"}),r=t.find(x=>x.month===i);return r?r.responses++:t.push({month:i,responses:1}),t},[]))||[],_=(s==null?void 0:s.sessions.reduce((t,n)=>{const i=new Date(n.created_at).toLocaleString("default",{month:"short",year:"2-digit"}),r=t.find(x=>x.month===i);return r?(r.sessions++,n.status==="completed"&&r.completed++):t.push({month:i,sessions:1,completed:n.status==="completed"?1:0}),t},[]))||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Organization Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg",children:"Total Responses"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold",children:(s==null?void 0:s.responses.length)||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"All time"})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg",children:"Active Sessions"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:b}),e.jsx("p",{className:"text-sm text-gray-600",children:"Currently active"})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg",children:"Completed Sessions"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:N}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total completed"})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg",children:"Team Members"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:v}),e.jsx("p",{className:"text-sm text-gray-600",children:"Active members"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(o,{children:"Monthly Response Trends"})}),e.jsx(c,{children:e.jsx(m,{width:"100%",height:300,children:e.jsxs(T,{data:C,children:[e.jsx(j,{strokeDasharray:"3 3"}),e.jsx(p,{dataKey:"month"}),e.jsx(g,{}),e.jsx(u,{}),e.jsx(k,{dataKey:"responses",fill:"#007ACE"})]})})})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(o,{children:"Session Completion Trends"})}),e.jsx(c,{children:e.jsx(m,{width:"100%",height:300,children:e.jsxs(A,{data:_,children:[e.jsx(j,{strokeDasharray:"3 3"}),e.jsx(p,{dataKey:"month"}),e.jsx(g,{}),e.jsx(u,{}),e.jsx(f,{type:"monotone",dataKey:"sessions",stroke:"#007ACE",strokeWidth:2,name:"Total Sessions"}),e.jsx(f,{type:"monotone",dataKey:"completed",stroke:"#10b981",strokeWidth:2,name:"Completed"})]})})})]})]})]})},L=({organizationId:a})=>e.jsx(R,{organizationId:a});export{L as FeedbackTab,L as default};
