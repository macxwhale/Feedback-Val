import{P,ae as R,ah as q,j as e,aq as w,C as d,k as x,q as h,T as u,l as g,b2 as j,b3 as _,i as p,B as z,b4 as A}from"./index-wLFAbMWJ.js";const B=({children:a,permission:s,organizationId:t,fallback:l,showRequiredRole:N=!0,onRequestAccess:c})=>{const{hasPermission:f,userRole:i,isLoading:v,isAdmin:b,error:m}=P(t),{isOrgAdmin:C}=R(),{organization:o}=q();if(v)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Checking permissions..."})]})});if(m)return console.error("Permission guard error:",m),e.jsxs(d,{className:"border-amber-200",children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center text-amber-600",children:[e.jsx(u,{className:"w-5 h-5 mr-2"}),"Permission Check Failed"]})}),e.jsx(g,{children:e.jsx("p",{className:"text-sm text-gray-600",children:"Unable to verify permissions. Please refresh the page or contact support if the issue persists."})})]});if(b||C)return console.log("Permission granted via admin privileges"),e.jsx(e.Fragment,{children:a});if(f(s))return console.log("Permission granted:",s),e.jsx(e.Fragment,{children:a});if(console.log("Permission denied:",{permission:s,userRole:i,organizationId:t}),l)return e.jsx(e.Fragment,{children:l});const y=F(s),n=j(y),r=i?j(i):null;return e.jsxs(d,{className:"border-red-200",children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center text-red-600",children:[e.jsx(_,{className:"w-5 h-5 mr-2"}),"Permission Required"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"You don't have permission to access this feature."})]}),o&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Organization:"})," ",o.name]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("span",{className:"font-medium",children:"Required permission:"})," ",s]})}),N&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Required role:"}),e.jsxs(p,{variant:n.variant,className:"flex items-center gap-1",children:[e.jsx(n.icon,{className:"w-3 h-3"}),n.label]})]}),r&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Your role:"}),e.jsxs(p,{variant:r.variant,className:"flex items-center gap-1",children:[e.jsx(r.icon,{className:"w-3 h-3"}),r.label]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[c&&e.jsxs(z,{onClick:c,size:"sm",className:"w-full",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Request Access"]}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Contact your organization administrator to request the required permissions."})]})]})]})};function F(a){return{view_analytics:"viewer",export_data:"analyst",manage_questions:"manager",manage_users:"admin",manage_integrations:"admin",manage_organization:"admin",manage_billing:"owner"}[a]||"admin"}export{B as P};
