import{c as d,j as e,C as i,m as l,P as x,l as u,w as N,i as m,T as q,n as M,aX as A,x as B,y as L,z as y,F as p}from"./index-DIy8U31k.js";import{u as P}from"./useAnalyticsTableData-DRmEyI6S.js";import{P as R}from"./PermissionGuard-CfK1ECGl.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=d("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=d("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=d("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),D=({sentimentStats:t,totalQuestions:s,overallScore:n})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(i,{children:e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Positive"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.positive}),e.jsxs("div",{className:"text-sm text-gray-500",children:[Math.round(t.positive/s*100),"% of questions"]}),e.jsx(x,{value:t.positive/s*100,className:"mt-2 h-2"})]})]})}),e.jsx(i,{children:e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Neutral"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.neutral}),e.jsxs("div",{className:"text-sm text-gray-500",children:[Math.round(t.neutral/s*100),"% of questions"]}),e.jsx(x,{value:t.neutral/s*100,className:"mt-2 h-2"})]})]})}),e.jsx(i,{children:e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Negative"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.negative}),e.jsxs("div",{className:"text-sm text-gray-500",children:[Math.round(t.negative/s*100),"% of questions"]}),e.jsx(x,{value:t.negative/s*100,className:"mt-2 h-2"})]})]})})]}),_=({sentiment:t})=>{switch(t){case"positive":return e.jsx(w,{className:"w-5 h-5 text-green-600"});case"negative":return e.jsx(f,{className:"w-5 h-5 text-red-600"});default:return e.jsx(b,{className:"w-5 h-5 text-yellow-600"})}},o=t=>{switch(t){case"positive":return"bg-green-100 text-green-800";case"negative":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}},F=t=>t.reduce((s,n)=>(s[n.sentiment]+=1,s),{positive:0,neutral:0,negative:0}),O=t=>t.positive>t.negative?"positive":t.negative>t.positive?"negative":"neutral",z=({questionSentiments:t})=>e.jsxs(i,{children:[e.jsx(u,{children:e.jsx(N,{children:"Question Sentiment Analysis"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:t.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(_,{sentiment:s.sentiment}),e.jsx(m,{className:o(s.sentiment),children:s.sentiment})]}),e.jsx("h4",{className:"font-medium text-sm",children:s.question_text}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.total_responses," responses • ",s.completion_rate,"% completion"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[s.completion_rate,"%"]}),s.sentiment==="negative"&&e.jsx(q,{className:"w-4 h-4 text-red-500 ml-auto mt-1"}),s.sentiment==="positive"&&e.jsx(M,{className:"w-4 h-4 text-green-500 ml-auto mt-1"})]})]},n))})})]}),E=({categorySentiments:t})=>e.jsxs(i,{children:[e.jsx(u,{children:e.jsx(N,{children:"Category Sentiment Analysis"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:t.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(_,{sentiment:s.sentiment}),e.jsx(m,{className:o(s.sentiment),children:s.sentiment})]}),e.jsx("h4",{className:"font-medium",children:s.category}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.total_questions," questions • ",s.total_responses," responses"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold",children:s.total_responses}),e.jsx("div",{className:"text-sm text-gray-500",children:"responses"})]})]},n))})})]}),G=({organizationId:t})=>{const{data:s,isLoading:n}=P(t);if(n)return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(a=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},a))})]})});if(!s)return e.jsx(i,{children:e.jsxs(l,{className:"p-6 text-center",children:[e.jsx(A,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"No sentiment data available"})]})});const r=s.questions.map(a=>{const c=a.trend==="positive"?"positive":a.trend==="negative"?"negative":"neutral";return{...a,sentiment:c}}),h=F(r),C=r.length,j=O(h),k=s.categories.map(a=>{const c=a.questions.filter(T=>T.trend==="positive").length,v=a.questions.length,g=v>0?c/v:0,S=g>.6?"positive":g<.3?"negative":"neutral";return{...a,sentiment:S}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Sentiment Analysis"}),e.jsxs(m,{className:o(j),children:["Overall: ",j]})]}),e.jsx(D,{sentimentStats:h,totalQuestions:C,overallScore:0}),e.jsxs(B,{defaultValue:"questions",className:"w-full",children:[e.jsxs(L,{className:"grid grid-cols-2 w-full max-w-md",children:[e.jsx(y,{value:"questions",children:"By Question"}),e.jsx(y,{value:"categories",children:"By Category"})]}),e.jsx(p,{value:"questions",className:"space-y-4",children:e.jsx(z,{questionSentiments:r.map(a=>({question_text:a.question_text,sentiment:a.sentiment,total_responses:a.total_responses,completion_rate:a.completion_rate}))})}),e.jsx(p,{value:"categories",className:"space-y-4",children:e.jsx(E,{categorySentiments:k.map(a=>({category:a.category,sentiment:a.sentiment,total_questions:a.total_questions,total_responses:a.total_responses}))})})]})]})},V=({organizationId:t})=>e.jsx(R,{permission:"view_analytics",organizationId:t,showRequiredRole:!0,fallback:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"You need viewer-level access or higher to view sentiment analysis."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your organization administrator for access."})]}),children:e.jsx(G,{organizationId:t})});export{V as SentimentTab,V as default};
