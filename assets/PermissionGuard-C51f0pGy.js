import{O as y,a9 as R,j as e,ak as P,C as m,l as o,t as d,T as x,m as h,a_ as g,a$ as w,i as j}from"./index-UWRg5VWb.js";const q=({children:a,permission:s,organizationId:t,fallback:c,showRequiredRole:u=!0})=>{const{hasPermission:p,userRole:i,isLoading:f,isAdmin:N,error:l}=y(t),{isOrgAdmin:v}=R();if(f)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Checking permissions..."})]})});if(l)return console.error("Permission guard error:",l),e.jsxs(m,{className:"border-amber-200",children:[e.jsx(o,{children:e.jsxs(d,{className:"flex items-center text-amber-600",children:[e.jsx(x,{className:"w-5 h-5 mr-2"}),"Permission Check Failed"]})}),e.jsx(h,{children:e.jsx("p",{className:"text-sm text-gray-600",children:"Unable to verify permissions. Please refresh the page or contact support if the issue persists."})})]});if(N||v)return console.log("Permission granted via admin privileges"),e.jsx(e.Fragment,{children:a});if(p(s))return console.log("Permission granted:",s),e.jsx(e.Fragment,{children:a});if(console.log("Permission denied:",{permission:s,userRole:i,organizationId:t}),c)return e.jsx(e.Fragment,{children:c});const C=b(s),n=g(C),r=i?g(i):null;return e.jsxs(m,{className:"border-red-200",children:[e.jsx(o,{children:e.jsxs(d,{className:"flex items-center text-red-600",children:[e.jsx(w,{className:"w-5 h-5 mr-2"}),"Access Restricted"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"You don't have permission to access this feature."})]}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Required role:"}),e.jsxs(j,{variant:n.variant,className:"flex items-center gap-1",children:[e.jsx(n.icon,{className:"w-3 h-3"}),n.label]})]}),r&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Your role:"}),e.jsxs(j,{variant:r.variant,className:"flex items-center gap-1",children:[e.jsx(r.icon,{className:"w-3 h-3"}),r.label]})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Contact your organization administrator to request access."})]})]})};function b(a){return{view_analytics:"viewer",export_data:"analyst",manage_questions:"admin",manage_users:"admin",manage_integrations:"admin",manage_organization:"admin",manage_billing:"owner"}[a]||"admin"}export{q as P};
