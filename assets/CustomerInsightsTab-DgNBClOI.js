import{j as e,C as n,f as r,$ as j,_ as L,E as q,M as y,B as l,Q as $,V as G,W as p,X as b,b as d,d as c,e as o,P as Q}from"./index-BuHaVz0Z.js";import{u as U}from"./useAnalyticsTableData-B6JUfuv7.js";import{R as f}from"./responsive-layout-CTzmNIAf.js";import{R as B,L as H,C as I,X as K,Y as P,T as W,a as F,b as w}from"./LineChart-Cvrt3Pcg.js";const V=({organizationId:m})=>{const{data:s,isLoading:_}=U(m);if(_)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-2 animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-96 animate-pulse"})]}),e.jsx("div",{className:"h-10 bg-gray-200 rounded w-32 animate-pulse"})]}),e.jsx(f,{columns:{xs:1,sm:2,md:2,lg:4},gap:"md",children:Array.from({length:4}).map((t,a)=>e.jsx(n,{children:e.jsxs(r,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mb-2 animate-pulse"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-16 mb-2 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 animate-pulse"})]})},a))})]});if(!s||s.summary.total_responses===0)return e.jsx(n,{children:e.jsxs(r,{className:"p-6 text-center",children:[e.jsx(j,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"No customer insights data available"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Customer insights will appear here once you have feedback responses."})]})});const i=s.summary.total_sessions,x=s.summary.completed_sessions,C=Math.round(x*.6),M=Math.round(x*.4),T=i-x,h=i>0?Math.round(s.summary.total_responses/i):0,S=(()=>{const t=new Date,a=[];for(let g=6;g>=0;g--){const u=new Date(t);u.setDate(u.getDate()-g);const R=s.summary.overall_completion_rate,D=(Math.random()-.5)*20,v=Math.max(0,Math.min(100,R+D)),k=Math.ceil(i/7),A=Math.floor(Math.random()*5)-2,N=Math.max(0,k+A);a.push({date:u.toLocaleDateString("en-US",{month:"short",day:"numeric"}),engagement:Math.round(v),sessions:N,completedSessions:Math.round(N*(v/100))})}return a})(),E=[{title:"Total Customers",value:s.summary.total_responses||0,change:s.summary.growth_rate||0,trend:(s.summary.growth_rate||0)>=0?"up":"down",icon:j,description:"Unique feedback participants"},{title:"Engagement Rate",value:`${s.summary.overall_completion_rate||0}%`,change:Math.max(0,Math.min(20,s.summary.overall_completion_rate-70)),trend:s.summary.overall_completion_rate>70?"up":"down",icon:L,description:"Session completion rate"},{title:"Avg. Questions Answered",value:h,change:Math.max(0,h-3),trend:h>3?"up":"down",icon:q,description:"Questions per session"},{title:"Customer Satisfaction",value:`${s.summary.user_satisfaction_rate||0}%`,change:Math.max(0,Math.min(25,(s.summary.user_satisfaction_rate||0)-60)),trend:(s.summary.user_satisfaction_rate||0)>60?"up":"down",icon:y,description:"Overall satisfaction rate"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Customer Insights"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Deep dive into customer behavior and engagement patterns"})]}),e.jsxs(l,{variant:"outline",className:"flex items-center space-x-2 self-start sm:self-auto",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs",children:"Real-time Data"})]})]}),e.jsx(f,{columns:{xs:1,sm:2,md:2,lg:4},gap:"md",children:E.map((t,a)=>e.jsx(n,{className:"hover:shadow-md transition-shadow duration-200",children:e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(t.icon,{className:"w-4 h-4 text-blue-600"})}),e.jsxs(l,{variant:t.trend==="up"?"default":"destructive",className:"text-xs",children:[t.trend==="up"?"+":"",t.change,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t.title}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:t.value}),e.jsx("p",{className:"text-xs text-gray-500",children:t.description})]})]})},a))}),e.jsxs($,{defaultValue:"segments",className:"w-full",children:[e.jsxs(G,{className:"grid w-full max-w-lg grid-cols-3",children:[e.jsx(p,{value:"segments",children:"Segments"}),e.jsx(p,{value:"journey",children:"Journey"}),e.jsx(p,{value:"behavior",children:"Behavior"})]}),e.jsx(b,{value:"segments",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsxs(c,{className:"flex items-center space-x-2",children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{children:"Customer Segments"})]}),e.jsx(o,{children:"Breakdown of customers by engagement level"})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg border-l-4 border-green-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Highly Engaged"}),e.jsx("p",{className:"text-xs text-green-600",children:"Completed 80%+ of sessions"})]}),e.jsx(l,{className:"bg-green-100 text-green-800",children:C})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Moderately Engaged"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Completed 50-80% of sessions"})]}),e.jsx(l,{className:"bg-blue-100 text-blue-800",children:M})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-orange-50 rounded-lg border-l-4 border-orange-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-orange-800",children:"Low Engagement"}),e.jsx("p",{className:"text-xs text-orange-600",children:"Completed less than 50%"})]}),e.jsx(l,{className:"bg-orange-100 text-orange-800",children:T})]})]})})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsxs(c,{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{children:"Engagement Trends"})]}),e.jsx(o,{children:"Customer engagement over time"})]}),e.jsx(r,{children:e.jsx(B,{width:"100%",height:200,children:e.jsxs(H,{data:S,children:[e.jsx(I,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"date"}),e.jsx(P,{}),e.jsx(W,{formatter:(t,a)=>[`${t}${a==="engagement"?"%":""}`,a==="engagement"?"Engagement Rate":a==="sessions"?"Total Sessions":"Completed Sessions"]}),e.jsx(F,{}),e.jsx(w,{type:"monotone",dataKey:"engagement",stroke:"#3b82f6",strokeWidth:2,name:"Engagement Rate"}),e.jsx(w,{type:"monotone",dataKey:"sessions",stroke:"#10b981",strokeWidth:2,name:"Total Sessions"})]})})})]})]})}),e.jsx(b,{value:"journey",className:"space-y-6 mt-6",children:e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"Customer Journey Analysis"}),e.jsx(o,{children:"Understanding how customers navigate through feedback sessions"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:i}),e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Started Sessions"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Initial engagement"})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-2",children:Math.round(i*.75)}),e.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"Mid-Session"}),e.jsx("p",{className:"text-xs text-yellow-600",children:"Continued engagement"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:x}),e.jsx("p",{className:"text-sm text-green-800 font-medium",children:"Completed"}),e.jsx("p",{className:"text-xs text-green-600",children:"Full journey completion"})]})]})})})]})}),e.jsx(b,{value:"behavior",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"Response Patterns"}),e.jsx(o,{children:"How customers interact with different question types"})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Multiple Choice"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Quick selections"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[s.summary.overall_completion_rate,"%"]}),e.jsx("div",{className:"text-xs text-green-600",children:"Response rate"})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Rating Scales"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Numerical feedback"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[Math.max(0,s.summary.overall_completion_rate-5),"%"]}),e.jsx("div",{className:"text-xs text-green-600",children:"Response rate"})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Open Text"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Written responses"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[Math.max(0,s.summary.overall_completion_rate-15),"%"]}),e.jsx("div",{className:"text-xs text-yellow-600",children:"Response rate"})]})]})]})})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"Key Insights"}),e.jsx(o,{children:"Actionable insights from customer behavior"})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-blue-800",children:["📈 ",s.summary.user_satisfaction_rate>70?"High satisfaction scores indicate strong customer sentiment":"Focus on improving satisfaction scores"]})}),e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-green-800",children:["✅ ",h>5?"Customers are highly engaged with longer sessions":"Consider shorter, focused question sets"]})}),e.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-amber-800",children:["⚠️ ",s.summary.overall_completion_rate<70?"Completion rate needs improvement - simplify questions":"Good completion rates maintained"]})}),e.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-purple-800",children:["🎯 ",s.summary.growth_rate>0?`Growing ${s.summary.growth_rate}% - maintain momentum`:"Focus on customer acquisition strategies"]})})]})})]})]})})]})]})},Z=({organizationId:m})=>e.jsx(Q,{permission:"view_analytics",organizationId:m,showRequiredRole:!0,fallback:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"You need viewer-level access or higher to view customer insights."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your organization administrator for access."})]}),children:e.jsx(V,{organizationId:m})});export{Z as CustomerInsightsTab,Z as default};
